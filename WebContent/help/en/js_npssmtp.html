<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>NpsSmtp</title>
<link href="/css/manual.css" rel="stylesheet" media="all" type="text/css">
</head>
<body id="manual-page">
<br>
<div id="page-content">
<div id="preamble"><h1><a id="#page-header">NpsSmtp class</a></h1>
    <div class="toplang"></div>
    <p> NpsSmtp is used to send email. Here is the sample codes for sending HTML formatted email with attachment.</p>
    <table border="1" width="100%">
        <tr><td>
            var f = new NpsFile('test.txt');<br>
            f.OpenWriter(false);<br>
            f.WriteString('hello from npsfile');<br>
            f.Close();<br><br>
            var client = new NpsSmtp("smtp.gmail.com",25);<br>
            client.Connect("xjwebstar@gmail.com","mypassword");<br>
            client.SetCharset('UTF-8');<br>
            client.SetFrom('xjwebstar@gmail.com');<br>
            client.AddTo('jialin@jwebstar.com');<br>
            client.AddCc('support@jwebstar.com');<br>
            client.AddBcc('service@jwebstar.com');<br>
            client.SetSubject('test from npsemail');<br>
            client.SetHtmlMsg('&lt;font color=red>hello from npsemail&lt;/font>');<br>
            client.AddAttach(f);<br>
            client.Send();<br>
        </td></tr>
    </table>
</div>

<div class="top"><a href="#page-header"><img alt="top" src="/images/help/up.gif"></a></div>
<div class="section">
    <h2>Method Summary</h2>
    <table class="related" cellspacing="0" cellpadding="0" border="1">
        <tbody>
            <tr class="module">
                <td width="100">NpsSmtp</td>
                <td>
                    NpsSmtp(String host,int port)<br>
                    Constructor.
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Connect(String user,String passwd)<br>
                    Connect to the smtp server for authentication using identified user and password.
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    ConnectSSL(String user,String passwd)<br>
                    Connect to the smtp server using SSL for authentication.
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetFrom(String from)<br>
            Set the FROM field of the email to use the specified address. </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetSubject(String subject)<br>
            Set the email subject.</td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    AddTo(String to)<br>
            Add a recipient TO to the email.</td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    AddBcc(String bcc)<br>
            Add a blind BCC recipient to the email.</td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetCharset(String charset)<br>
            Set the charset of the message.i,e,GBK、UTF-8、ISO8859-1.Default charset
            is ISO8859-1.</td>
            </tr>

            <tr class="module">
                <td>void</td>
                <td>
                    SetTextMsg(String msg)<br>
            Set the text content. </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetHtmlMsg(String msg)<br>
            Set the html content. </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    AddAttach(NpsFile file)<br>
            Attach a file located by file.</td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Send()<br>
            Sends the email.</td>
            </tr>
        </tbody>
    </table>
</div>

</div>
</body>
</html>