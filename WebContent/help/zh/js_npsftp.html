<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>NpsFtp</title>
<link href="/css/manual.css" rel="stylesheet" media="all" type="text/css">
</head>
<body id="manual-page">
<br>
<div id="page-content">
<div id="preamble"><h1><a id="#page-header">NpsFtp class</a></h1>
    <div class="toplang"></div>
    <p> NpsFtp用于执行FTP命令。<br>
        以下代码演示了从www.jwebstar.com上下载日志文件。
    </p>
    <table border="1" width="100%">
        <tr><td>
            var ftp = new NpsFtp();<br>
            ftp.Connect('www.jwebstar.com',21);<br>
            ftp.Login('nps','nps');<br>
            ftp.ChangeWorkingDirectory('/pub');<br>
            ftp.SetBinary();<br>
            ftp.MGet(new NpsFile('/jwebstarlog/'),'jwebstar*.log');<br>
            ftp.Disconnect();<br>
        </td></tr>
    </table>
</div>

<div class="top"><a href="#page-header"><img alt="top" src="/images/help/up.gif"></a></div>
<div class="section">
    <h2>Method Summary</h2>
    <table class="related" cellspacing="0" cellpadding="0" border="1">
        <tbody>
            <tr class="module">
                <td width="100"></td>
                <td>
                    NpsFtp()<br>
                    构造函数。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Connect(String server,int port) throws Exception<br>
                    使用端口port连接server。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Login(String uname,String upass) throws IOException<br>
                    使用帐号uname，密码upass登录。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    ChangeWorkingDirectory(String path) throws IOException<br>
                    改变当前工作目录。
                </td>
            </tr>
            <tr class="module">
                <td>String</td>
                <td>
                    PrintWorkingDirectory() throws IOException<br>
                    返回当前工作目录。
                </td>
            </tr>
            <tr class="module">
                <td>boolean</td>
                <td>
                    MkDir(String path) throws IOException<br>
                    创建path指定的目录，成功返回true，否则返回false。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    MkDirs(String path) throws IOException<br>
                    创建path指定的目录，包括创建其父目录。
                </td>
            </tr>
            <tr class="module">
                <td>boolean</td>
                <td>
                    RemoveDir(String path) throws IOException<br>
                    删除目录。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetAscii() throws IOException<br>
                    设定以ASCII方式传送文件。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetBinary() throws IOException<br>
                    设定以二进制方式传送文件。
                </td>
            </tr>
            <tr class="module">
                <td>boolean</td>
                <td>
                    Get(String filename,NpsFile local) throws Exception<br>
                    将远程服务器上的文件名为filename的文件保存到指定的本地文件local中。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    MGet(NpsFile local_dir,String filter) throws Exception<br>
                    将远程服务器上的当前工作目录下满足filter条件的所有文件或目录保存到本地目录local_dir下。<br>
                    filter是条件过滤器，可以使用DOS格式的通配符，*可以代替文件名中的多个字符，而?只能代替文件名中的一个字符。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Put(NpsFile local) throws Exception<br>
                    将本地文件local上传到远程服务器当前工作目录下。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    MPut(NpsFile local_dir,String filter) throws Exception<br>
                    将本地指定目录local_dir下满足filter条件的所有文件及目录上传到远程服务器当前工作目录下。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Delete(String filename)  throws IOException<br>
                    删除远程服务器上名为filename的文件。
                </td>
            </tr>
            <tr class="module">
                <td>boolean</td>
                <td>
                    Rename(String from,String to)  throws IOException<br>
                    将远程服务器上名为from的文件重命名为to。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Logout() throws IOException<br>
                    从远程服务器上注销。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Disconnect() throws IOException<br>
                    与远程服务器断开连接。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    Abort() throws IOException<br>
                    中断与远程服务器的传输。
                </td>
            </tr>
        </tbody>
    </table>
</div>

</div>
</body>
</html>