<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>工作流节点命令二次开发 - SQL编程指南 - NPS Version 2.x Documentation </title>
<link href="/css/manual.css" rel="stylesheet" media="all" type="text/css">
</head>
<body id="index-page">
<div id="path"></div>
<div id="page-content">
  <h1>工作流节点命令二次开发 - SQL编程指南 - NPS Version 2.x Documentation</h1>
    <p>工作流节点可以使用<a href="wf_command_js.html">JavaScript</a>、<a href="wf_command_java.html">DynamicJava</a>、SQL三种语言进行业务编程。这里着重介绍如何使用SQL进行二次开发。
       <br>
       NPS将自动生成ORACLE规格的Declare语句定义所有变量，语句如下：
    </p>
    <table class="related"  width=60% cellspacing="0" cellpadding="0" border="1">
      <tbody>
          <tr>
              <th>自动生成的SQL语句</th>
          </tr>
          <tr class="module">
            <td>
                Declare <br>
                     TYPE T_PARTICIPANT is RECORD( <br>
                         id VARCHAR2(36), <br>
                         name VARCHAR2(50)); <br>
                    <br>
                     TYPE ARRAY_PARTICIPANT IS TABLE OF T_PARTICIPANT INDEX BY Binary_Integer;<br><br>
                     action number := 3;<br>
                     suggest varchar2(1000);<br>
                     attorney T_PARTICIPANT;<br>
                     participant T_PARTICIPANT;<br>
                     participants ARRAY_PARTICIPANT;<br>
                     app_id varchar2(36) :='';<br>
                     app_title varchar2(1000):='';<br>
                     app_emergency number:=0; <br>
                     app_businesstype varchar2(36):='';<br>
                     app_process varchar2(36):= ''; <br><br>
            </td>
          </tr>
          <tr class="module">
            <td>
                <font color=red>
                //以下定义依赖于IApp.toJSONString()实现，NPS将自动以app_开头定义变量<br>
                app_money VARCHAR2(50):='';<br><br>
                </font>
            </td>
          </tr>
          <tr class="module">
            <td>
                begin<br>
                <font color=red>
                //你的代码将出现在这里<br>
                your sql goes here!<br>
                </font>
                end;<br>
            </td>
          </tr>
      </tbody>
   </table>
    <p><b>变量说明</b></p>
    <table class="related"  width=60% cellspacing="0" cellpadding="0" border="1">
        <tbody>
            <tr>
                <th>变量名</th>
                <th>类型</th>
                <th>含义</th>
            </tr>
            <tr class="module">
                <td>action</td>
                <td>number</td>
                <td>1=驳回，2=退回某个节点重新审批，3=同意，4=审批通过后撤销</td>
            </tr>
            <tr class="module">
                <td>suggest</td>
                <td>varchar2</td>
                <td>审批意见</td>
            </tr>
            <tr class="module">
                <td>attorney</td>
                <td>T_PARTICIPANT</td>
                <td>委托办理用户身份信息</td>
            </tr>
            <tr class="module">
                <td>participants</td>
                <td>ARRAY_PARTICIPANT</td>
                <td>下一流程审批人列表</td>
            </tr>
            <tr class="module">
                <td>app_id</td>
                <td>varchar2</td>
                <td>申请表ID#</td>
            </tr>
            <tr class="module">
                <td>app_title</td>
                <td>varchar2</td>
                <td>申请表标题</td>
            </tr>
            <tr class="module">
                <td>app_emergency</td>
                <td>number</td>
                <td>紧急程度。 0普通 5紧急 9特急</td>
            </tr>
            <tr class="module">
                <td>app_businesstype</td>
                <td>varchar2</td>
                <td>业务类型ID#</td>
            </tr>
            <tr class="module">
                <td>app_process</td>
                <td>varchar2</td>
                <td>业务流程ID#</td>
            </tr>
            <tr class="module">
                <td>app_<业务自定义字段></td>
                <td>varchar2</td>
                <td>业务数据</td>
            </tr>
        </tbody>
    </table>
    <p style="padding-top:150px"></p>
</div>
</body>
</html>