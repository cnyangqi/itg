<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>NpsTemplate</title>
<link href="/css/manual.css" rel="stylesheet" media="all" type="text/css">
</head>
<body id="manual-page">
<br>
<div id="page-content">
<div id="preamble"><h1><a id="#page-header">NpsTemplate class</a></h1>
    <div class="toplang"></div>
    <p> NpsTemplate用于基于NPS内核生成通用模板。例如电子邮件模板。</p>
    <table border="1" width="100%">
        <tr><td>
            var f = new NpsFile('test.txt');<br>
            f.OpenWriter(false);<br>
            f.WriteString('hello from npsfile');<br>
            f.Close();<br><br>
            var client = new NpsSmtp("smtp.gmail.com",25);<br>
            client.Connect("xjwebstar@gmail.com","mypassword");<br>
            client.SetCharset('UTF-8');<br>
            client.SetFrom('xjwebstar@gmail.com');<br>
            client.AddTo('jialin@jwebstar.com');<br>
            client.AddCc('support@jwebstar.com');<br>
            client.AddBcc('service@jwebstar.com');<br>
            client.SetSubject('test from npsemail');<br>
            client.SetHtmlMsg('&lt;font color=red>hello from npsemail&lt;/font>');<br>
            client.AddAttach(f);<br>
            client.Send();<br>
        </td></tr>
    </table>
</div>

<div class="top"><a href="#page-header"><img alt="top" src="/images/help/up.gif"></a></div>
<div class="section">
    <h2>Method Summary</h2>
    <table class="related" cellspacing="0" cellpadding="0" border="1">
        <tbody>
            <tr class="module">
                <td width="100">NpsTemplate</td>
                <td>
                    NpsTemplate(String id,String name,String class_prefix)<br>
                    构造函数。id是模板ID号，name是模板名称，class_prefix是输出类前缀。<br>
                    自动生成的class文件命名规则："nps.runtime." + class_prefix + id
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    SetTemplate(String template)<br>
                    设置模板。
                </td>
            </tr>
            <tr class="module">
                <td>String</td>
                <td>
                    Evaluate()<br>
                    替换后输出文本。
                </td>
            </tr>
            <tr class="module">
                <td>void</td>
                <td>
                    EvaluateToFile(NpsFile output)<br>
                    替换后输出文本到指定的output文件。
                </td>
            </tr>
        </tbody>
    </table>
</div>

</div>
</body>
</html>